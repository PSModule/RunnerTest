name: OSVersion

on: push

jobs:
  test:
    strategy:
      matrix:
        shell: [pwsh]
        os: [macos-latest, windows-latest, ubuntu-latest]
        include:
          - shell: powershell
            os: [windows-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - name: Run a multi-line script
        shell: pwsh
        run: |
          Write-Host '::group::OSVersion'
          Write-Host ([System.Environment]::OSVersion | Out-String)
          Write-Host '::endgroup::'

          Write-Host '::group::PSVersionTable'
          Write-Host ($PSVersionTable | Out-String)
          Write-Host '::endgroup::'

          Write-Host '::group::Environment variables'
          Write-Host (Get-ChildItem env: | sort-object Name | Select-Object Name, Value | Out-String)
          Write-Host '::endgroup::'

          Write-Host '::group::PowerShell variables'
          Write-Host (Get-Variable | Format-Table -AutoSize | Out-String)
          Write-Host '::endgroup::'
